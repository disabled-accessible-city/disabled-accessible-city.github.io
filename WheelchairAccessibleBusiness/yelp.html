<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <title>Wheelchair Accessible Business</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />

    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.2.0/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.2.0/mapbox-gl-geocoder.css' type='text/css' />
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<style>
.map-overlay {
    font: 12px/20px 'Open Sans', Arial, Helvetica, sans-serif;
    position: absolute;
    width: 310px;
    min-width: 310px;
    bottom: 0px;
    left: 0px;
    padding: 10px;
}
.map-overlay .map-overlay-inner {
    background-color: rgba(225, 225, 225, 0.9);
    box-shadow:0 1px 2px rgba(0, 0, 0, 0.20);
    border-radius: 3px;
    padding: 10px;
    margin-bottom: 10px;
}
.map-overlay table {
    border: none;
    width: 100%;
}

.map-overlay h2 {
    line-height: 24px;
    display: block;
    margin: 0 0 10px;
}

.map-overlay label {
    font: 18px/20px 'Open Sans', Arial, Helvetica, sans-serif;
    display: block;
    margin: 0 0 0 10px;
    padding: 0;
}
.legend {
    background-color: rgba(150,150,150,0.8);  
    border-radius: 3px;
    bottom: 20px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.10);
    font: 12px/20px 'Open Sans', sans-serif;
    color: #fff;
    padding: 10px;
    position: absolute;
    right: 40px;
    z-index: 1;
}
.legend h4 {
    margin: 0 0 5px;
    font-size: 18px
}
.legend div span {
    border-radius: 50%;
    display: inline-block;
    height: 10px;
    margin-right: 10px;
    width: 10px;
}
</style>
<div id='state-legend' class='legend'>
    <h4>Business Type</h4>
    <div><span style='background-color: #F44336'></span>Restaurants</div>
    <div><span style='background-color: #FF9800'></span>Food</div>
    <div><span style='background-color: #FFEB3B'></span>Shopping</div>
    <div><span style='background-color: #4CAF50'></span>Travel</div>
    <div><span style='background-color: #03A9F4'></span>Leisure</div>
    <div><span style='background-color: #3F51B5'></span>Night Life</div>
    <div><span style='background-color: #9C27B0'></span>Beauty and Health</div>
    <div><span style='background-color: #607D8B'></span>Local Services</div>
</div>
<nav id="menu"></nav>
<style>
    #menu {
        background: #fff;
        position: absolute;
        z-index: 1;
        top: 20px;
        right: 40px;
        border-radius: 3px;
        width: 120px;
        border: 1px solid rgba(255,255,255,0.4);
        font-family: 'Open Sans', sans-serif;
    }
    #menu a {
        font-size: 12px;
        color: #404040;
        display: block;
        margin: 0;
        padding: 0;
        padding: 3px;
        text-decoration: none;
        border-bottom: 2px solid rgba(255,255,255,0.4);
        text-align: center;
    }
    #menu a:last-child {
        border: none;
    }
    #menu a:hover {
        background-color: #f8f8f8;
        color: #404040;
        box-shadow:inset 0 0 0 3px rgba(0, 0, 0, 0.10)
    }
    #menu a.active {
        background-color: #FBC02D; 
        color: #ffffff;
    }
    #menu a.active:hover {
        background: #9E9E9E;
        box-shadow:inset 0 0 0 3px rgba(0, 0, 0, 0.10)
    }
</style>
<div id='map'></div>
<div class='map-overlay top'>
    <div class='map-overlay-inner'>
        <h2>Wheelchair Accessible Business</h2> 
        <h2>in Each Borough</h2>
        <img src="try.png" alt="Try" style="width:290px;height:470px;">
        
</div>
</div>
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiY2xhaXJleWUiLCJhIjoiY2puMzl1cHpvNTFxNDNxbng4aDBjenVhNSJ9.AaoQSeMFSTt2Wq97UxUjAg';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/claireye/cjuqvamgo3bxf1fs0hxkgmtzn',
    zoom: 11,
    center: [-0.13, 51.51]
});
    
map.on('load', function() {
    
    var geocoder = new MapboxGeocoder({
        accessToken: mapboxgl.accessToken,
        mapboxgl: mapboxgl,
        zoom: 13,
        placeholder: "Enter an address or place name",
        bbox: [-0.33, 51.31, 0.07, 51.71]
      });

    map.addControl(geocoder, 'top-left');
    
    map.addLayer({
                id: 'Local Services',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.0frgh0v7'
                },
                'source-layer': 'localservices-czie4g',
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#607D8B',
                    'circle-opacity': 0.8,
                    'circle-radius': {
                            property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 3}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
              });
    // Another event listener that adds the popup when the user puts their cursor over the circles
    var mypopup = new mapboxgl.Popup({closeButton: false});
    function popup(layer) {
            map.on('mouseover', 'layer', function (e) {
                    mypopup
                        .setLngLat(e.features[0].geometry.coordinates)
                        .setHTML(
                        "<h3>" + e.features[0].properties.name 
                        + "</h3>Categories: " + e.features[0].properties.categories 
                        + "<br />Image Url: " + e.features[0].properties.image_url
                        + "<br />Location: " + e.features[0].properties.location 
                        + "<br />Phone Number: " + e.features[0].properties.display_phone 
                        + "<br />Price: " + e.features[0].properties.price 
                        + "<br />Rating: " + e.features[0].properties.rating)
                        .addTo(map);
                });

            // Change the cursor to a pointer when the mouse is over the layer.
            map.on('mouseenter', 'layer', function () {
                  map.getCanvas().style.cursor = 'pointer';
            });

            // Change it back to a pointer when it leaves and remove the popup window.
            map.on('mouseleave', 'layer', function () {
                map.getCanvas().style.cursor = '';
                mypopup.remove();
            });
        return layer;
    }
    map.on(popup('Local Services'))
          
    map.addLayer({
                id: 'Night Life',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.arbeeu8q'
                },
                'source-layer': 'nightlife-9jwtge',
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#3F51B5',
                    'circle-opacity': 0.8,
                    'circle-radius': {
                        property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 5}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
              });
    map.on('mouseover', 'Night Life', function (e) {
                    mypopup
                        .setLngLat(e.features[0].geometry.coordinates)
                        .setHTML('<h3><a href="' + feature.properties.url_image + '">' + feature.properties.name + '</a></h3>')
                        .addTo(map);
                });

            // Change the cursor to a pointer when the mouse is over the layer.
            map.on('mouseenter', 'Night Life', function () {
                  map.getCanvas().style.cursor = 'pointer';
            });

            // Change it back to a pointer when it leaves and remove the popup window.
            map.on('mouseleave', 'Night Life', function () {
                map.getCanvas().style.cursor = '';
                mypopup.remove();
            });
      
    map.addLayer({
                id: 'Restaurants',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.1qd93btj'
                },
                'source-layer': 'restaurants-8rpp0o', 
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#F44336',
                    'circle-opacity': 0.8,
                    'circle-radius': {
                        property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 5}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
              });
    
    map.on('mouseover', 'Restaurants', function (e) {
                    mypopup
                        .setLngLat(e.features[0].geometry.coordinates)
                        .setHTML("<h3>" + e.features[0].properties.name + '</h3><img src="' + e.features[0].properties.image_url + '" width = 250px>' + "<br />Categories: " + e.features[0].properties.title + "<br />Location: " + e.features[0].properties.display_address + "<br />Phone Number: " + e.features[0].properties.display_phone + "<br />Price: " + e.features[0].properties.price + "<br />Rating: " + e.features[0].properties.rating + "<br />Review Count: " + e.features[0].properties.review_count)
                        .addTo(map);
        
                });

            // Change the cursor to a pointer when the mouse is over the layer.
            map.on('mouseenter', 'Restaurants', function () {
                  map.getCanvas().style.cursor = 'pointer';
            });

            // Change it back to a pointer when it leaves and remove the popup window.
            map.on('mouseleave', 'Restaurants', function () {
                map.getCanvas().style.cursor = '';
                mypopup.remove();
            });
    
    map.addLayer({
                id: 'Food',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.3hp82xle' 
                },
                'source-layer': 'food-79m22t', 
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#FF9800',
                    'circle-opacity': 0.8,
                    'circle-radius': {
                        property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 5}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
              });  
    
    map.on('mouseover', 'Food', function (e) {
                    mypopup
                        .setLngLat(e.features[0].geometry.coordinates)
                        .setHTML("<h3>" + e.features[0].properties.name + "</h3>Categories: " + e.features[0].properties.categories + '<br /><img src="' + e.features[0].properties.image_url + '">' + "<br />Location: " + e.features[0].properties.location + "<br />Phone Number: " + e.features[0].properties.display_phone + "<br />Price: " + e.features[0].properties.price + "<br />Rating: " + e.features[0].properties.rating)
                        .addTo(map);
                });

            // Change the cursor to a pointer when the mouse is over the layer.
            map.on('mouseenter', 'Food', function () {
                  map.getCanvas().style.cursor = 'pointer';
            });

            // Change it back to a pointer when it leaves and remove the popup window.
            map.on('mouseleave', 'Food', function () {
                map.getCanvas().style.cursor = '';
                mypopup.remove();
            });
    
    map.addLayer({
                id: 'Shopping',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.bo6lc0xg' 
                },
                'source-layer': 'shopping-6i9rg6', 
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#FFEB3B',
                    'circle-opacity': 0.8,
                    'circle-radius': {
                        property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 5}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
              });
    
       map.on('mouseover', 'Shopping', function (e) {
                    mypopup
                        .setLngLat(e.features[0].geometry.coordinates)
                        .setHTML("<h3>" + e.features[0].properties.name + "</h3>Categories: " + e.features[0].properties.categories + '<br /><img src="e.features[0].properties.image_url">' + "<br />Location: " + e.features[0].properties.location + "<br />Phone Number: " + e.features[0].properties.display_phone + "<br />Price: " + e.features[0].properties.price + "<br />Rating: " + e.features[0].properties.rating)
                        .addTo(map);
                });

            // Change the cursor to a pointer when the mouse is over the layer.
            map.on('mouseenter', 'Shopping', function () {
                  map.getCanvas().style.cursor = 'pointer';
            });

            // Change it back to a pointer when it leaves and remove the popup window.
            map.on('mouseleave', 'Shopping', function () {
                map.getCanvas().style.cursor = '';
                mypopup.remove();
            }); 
    
    map.addLayer({
                id: 'Travel',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.cjv9j6kmu0li62rlmjvdswqko-6zg13'
                },
                'source-layer': 'hoteltravel',
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#4CAF50',
                    'circle-opacity': 0.8,
                    'circle-radius': {
                        property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 5}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
              });
    
    map.addLayer({
                id: 'Leisure',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.87wx8sem'
                },
                'source-layer': 'active-d7goq5',
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#03A9F4',   
                    'circle-opacity': 0.8,
                    'circle-radius': {
                        property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 5}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
              });

    map.addLayer({
                id: 'Beauty & Health',
                type: 'circle',
                source: {
                  type: 'vector',
                  url: 'mapbox://claireye.7ludt3iq'
                },
                'source-layer': 'beautyhealth-95jpi8',
                'layout': {
                    'visibility': 'visible'
                },
                paint: {
                    'circle-color': '#9C27B0',
                    'circle-opacity': 0.8,
                    'circle-radius': {
                        property: 'rating',
                            stops: [
                                [{zoom: 10, value: 3}, 2],
                                [{zoom: 10, value: 5}, 3],
                                [{zoom: 15, value: 3}, 6],
                                [{zoom: 15, value: 5}, 8],
                                [{zoom: 18, value: 3}, 12],
                                [{zoom: 18, value: 5}, 15],
                                ]
                        }}
               });
});

var toggleableLayerIds = [ 'Restaurants', 'Food', 'Shopping', 'Travel', 'Leisure', 'Night Life', 'Beauty & Health', 'Local Services'];

var LayerColors = ['#F44336', '#FF9800', '#FFEB3B', '#4CAF50', '#03A9F4', '#3F51B5', '#9C27B0', '#607D8B'];
    
for (var i = 0; i < toggleableLayerIds.length; i++) {
    var id = toggleableLayerIds[i];
    var color = LayerColors[i]

    var link = document.createElement('a');
    link.href = '#';
    link.className = 'active';
    link.textContent = id;
    link.style.backgroundColor = color;

    link.onclick = function (e) {
        var clickedLayer = this.textContent;
        e.preventDefault();
        e.stopPropagation();

        var visibility = map.getLayoutProperty(clickedLayer, 'visibility');

        if (visibility === 'visible') {
            map.setLayoutProperty(clickedLayer, 'visibility', 'none');
            this.className = '';
        } 
        else {
            this.className = 'active';
            map.setLayoutProperty(clickedLayer, 'visibility', 'visible');
        }
    };

    var layers = document.getElementById('menu');
    layers.appendChild(link);
}

</script>
    
</body>
</html>